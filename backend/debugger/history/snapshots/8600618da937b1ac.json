{
  "files": {
    "C:\\Users\\Apurav\\Downloads\\Dynamic_IDE\\Dynamic_IDE\\backend\\debugger\\main.py": "from fastapi import FastAPI\nfrom pydantic import BaseModel\n\nfrom analyzer.resolver import resolve\nfrom analyzer.snapshot import load_snapshot, save_snapshot\nfrom diff.compare import diff_snapshots\n\napp = FastAPI()\n\nclass DebugRequest(BaseModel):\n    entry_file: str\n    user_prompt: str\n\n@app.post(\"/debug\")\ndef debug_code(req: DebugRequest):\n    current_output = resolve(req.entry_file)\n\n    previous_output = load_snapshot(req.entry_file)\n\n    diff_output = diff_snapshots(previous_output, current_output)\n\n    save_snapshot(req.entry_file, current_output)\n\n    return {\n        \"entry_file\": req.entry_file,\n        \"changed_files\": diff_output,\n        \"prompt\": req.user_prompt\n    }\n",
    "C:\\Users\\Apurav\\Downloads\\Dynamic_IDE\\Dynamic_IDE\\backend\\debugger\\analyzer\\resolver.py": "import os\n\nfrom analyzer.extractor import extract_imports\n\ndef resolve(entry_file: str):\n    visited = set()\n    files = {}\n\n    def dfs(file_path):\n        file_path = os.path.abspath(file_path)\n\n        if file_path in visited:\n            return\n\n        if not os.path.exists(file_path):\n            return\n\n        visited.add(file_path)\n        print(\"f\")\n        \n\n        with open(file_path, \"r\", encoding=\"utf-8\", errors=\"ignore\") as f:\n            code = f.read()\n\n        files[file_path] = code\n\n        imports = extract_imports(code, file_path)\n\n        for imp in imports:\n            dfs(imp)\n\n    dfs(entry_file)\n\n    return {\"files\": files}\n",
    "C:\\Users\\Apurav\\Downloads\\Dynamic_IDE\\Dynamic_IDE\\backend\\debugger\\analyzer\\snapshot.py": "import json\nimport os\nfrom utils.hash import snapshot_key\n\nSNAPSHOT_DIR = \"history/snapshots\"\nos.makedirs(SNAPSHOT_DIR, exist_ok=True)\n\ndef _snapshot_path(entry_file):\n    key = snapshot_key(entry_file)\n    return os.path.join(SNAPSHOT_DIR, f\"{key}.json\")\n\ndef load_snapshot(entry_file):\n    path = _snapshot_path(entry_file)\n    if not os.path.exists(path):\n        return None\n    with open(path, \"r\") as f:\n        return json.load(f)\n\ndef save_snapshot(entry_file, data):\n    path = _snapshot_path(entry_file)\n    with open(path, \"w\") as f:\n        json.dump(data, f, indent=2)\n",
    "C:\\Users\\Apurav\\Downloads\\Dynamic_IDE\\Dynamic_IDE\\backend\\debugger\\diff\\compare.py": "import difflib\n\ndef diff_snapshots(old, new):\n    if old is None:\n        return new  # first run \u2192 return full output\n\n    changed_files = {}\n\n    old_files = old[\"files\"]\n    new_files = new[\"files\"]\n    print(\"hello\")\n\n    for file, new_code in new_files.items():\n        old_code = old_files.get(file)\n\n        if old_code is None:\n            changed_files[file] = new_code\n        elif old_code != new_code:\n            diff = difflib.unified_diff(\n                old_code.splitlines(),\n                new_code.splitlines(),\n                lineterm=\"\"\n            )\n            changed_files[file] = \"\\n\".join(diff)\n\n    return {\"files\": changed_files}\n"
  }
}